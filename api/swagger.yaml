swagger: "2.0"
info:
  description: "测试环境需要`header`设置 `api_key` = `special-key` 来进行安全认证.\n\nJSON中汉字转义后输出，如`汉字` 输出`\"\\u6c49\\u5b57\"`\n\n\n测试服务端Go代码:github.com/zc310/yccodeserver"
  version: "1.0.0"
  title: "号码导入接口"
  termsOfService: "https://www.82608000.com/"
  contact:
    email: "93672020@qq.com"

host: "test.82608000.com"
basePath: "/api/v1"
tags:
  - name: "code"
    description: "号码导入"
    externalDocs:
      description: "号码格式说明"
      url: "https://www.82608000.com/help/tzd/code.html"
schemes:
  - "http"
paths:
  /code:
    get:
      tags:
        - "code"
      summary: "获取方案"
      description: "根据方案时间查询方案列表"
      operationId: "code"
      produces:
        - "application/json"

      responses:
        200:
          description: "操作成功"
          schema:
            type: "array"
            items:
              $ref: "#/definitions/Code"
        401:
          description: "API key 无效"
      security:
        - api_key: []
  /code/{Id}:
    get:
      tags:
        - "code"
      summary: "按单号查询方案号码"
      description: "返回投注号码"
      operationId: "getCodeById"
      produces:
        - "application/json"
      parameters:
        - name: "Id"
          in: "path"
          description: "方案编号"
          required: true
          type: "string"

      responses:
        200:
          description: "操作成功"
          schema:
            type: "string"
        401:
          description: "API key 无效"
        404:
          description: "方案未找到"

      security:
        - api_key: []
  /code/print-notification:
    post:
      summary: 提交打印完成通知
      description: 接收一个投注单的打印完成通知，进行记录和后续处理。支持多次重试机制。
      parameters:
        - in: body
          name: body
          description: 打印通知请求数据
          required: true
          schema:
            $ref: '#/definitions/PrintNotificationRequest'
      responses:
        '200':
          description: 通知处理结果
          schema:
            $ref: '#/definitions/PrintNotificationResponse'
        401:
          description: "API key 无效"
        404:
          description: "方案未找到"

securityDefinitions:

  api_key:
    type: "apiKey"
    name: "api_key"
    in: "header"
definitions:
  Code:
    type: "object"
    properties:
      id:
        type: "string"
        description: "单号"
      lot:
        $ref: '#/definitions/Lot'
      issue:
        type: "string"
        description: "期号"
      count:
        type: "integer"
        description: "注数"
      note:
        type: "string"
        description: "备注"
      time:
        type: "string"
        format: "date-time"
        description: "时间"
      add:
        type: "boolean"
        description: "追加投注(可选,大乐透专用)"
      multi_issue:
        type: "integer"
        description: "多期(可选,默认1期)"
      multiple:
        type: "integer"
        description: "倍数(可选,默认1倍)"

  Lot:
    type: string
    description: "彩种"
    enum:
      - 竞彩足球
      - 竞彩篮球
      - 单场
      - 胜负彩
      - 任选九
      - 半全场
      - 进球彩
      - 排列3
      - 排列5
      - 大乐透
      - 七星彩
  PrintNotificationRequest:
    type: object
    properties:
      orderNo:
        type: string
        description: 投注单编号
        example: TZD123456789
      printTime:
        type: string
        description: 打印时间，推荐使用 ISO8601 格式，如 "2024-06-01T14:30:00+08:00"
        example: "2024-06-01T14:30:00+08:00"
      notifyCount:
        type: integer
        description: 当前通知次数，从 1 开始
        example: 1
    required:
      - orderNo
      - printTime
      - notifyCount

  PrintNotificationResponse:
    type: object
    properties:
      success:
        type: boolean
        description: 是否处理成功
        example: true
      message:
        type: string
        description: 处理结果描述信息
        example: "通知已记录"
externalDocs:
  description: "查看更多信息"
  url: "http://www.82608000.com"